

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>geopm_agent_frequency_map(7) – agent for running regions at user selected frequencies &mdash; GEOPM  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="geopm_agent_gpu_activity(7) – agent for selecting GPU frequency based on GPU compute activity" href="geopm_agent_gpu_activity.7.html" />
    <link rel="prev" title="geopm_agent_ffnet(7) – agent for adjusting frequencies based on application behavior" href="geopm_agent_ffnet.7.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GEOPM
              <img src="https://geopm.github.io/images/geopm-logo-clear.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guides.html">User Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="devel.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="reference.html">Reference Manual</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="reference.html#geopm-manual-pages">GEOPM Manual Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="geopm.7.html">geopm(7) – Global Extensible Open Power Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio.7.html">geopm_pio(7) – GEOPM PlatformIO interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_cnl.7.html">geopm_pio_cnl(7) – Signals and controls for Compute Node Linux Board-Level Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_const_config.7.html">geopm_pio_const_config(7) – Signals for ConstConfigIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_cpuinfo.7.html">geopm_pio_cpuinfo(7) – Signals and controls for the CPUInfoIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_dcgm.7.html">geopm_pio_dcgm(7) – IOGroup providing signals and controls for NVIDIA GPUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_levelzero.7.html">geopm_pio_levelzero(7) – IOGroup providing signals and controls for Intel GPUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_msr.7.html">geopm_pio_msr(7) – Signals and controls for Model Specific Registers (MSRs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_nvml.7.html">geopm_pio_nvml(7) – IOGroup providing signals and controls for NVIDIA GPUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_profile.7.html">geopm_pio_profile(7) – Signals and controls for the ProfileIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_service.7.html">geopm_pio_service(7) – Signals and controls for the ServiceIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_sst.7.html">geopm_pio_sst(7) – Signals and controls for Intel Speed Select Technology</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_sysfs.7.html">geopm_pio_sysfs(7) – Signals and controls for sysfs attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_time.7.html">geopm_pio_time(7) – Signals and controls for Time IO Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmaccess.1.html">geopmaccess(1) – Access management for the GEOPM Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmadmin.1.html">geopmadmin(1) – tool for GEOPM system administrators</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmagent.1.html">geopmagent(1) – query agent information and create static policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmbench.1.html">geopmbench(1) – synthetic benchmark application</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmctl.1.html">geopmctl(1) – GEOPM runtime control application</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmendpoint.1.html">geopmendpoint(1) – command line tool for dynamic policy control</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmexporter.1.html">geopmexporter(1) – Prometheus exporter for GEOPM metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmlaunch.1.html">geopmlaunch(1) – application launch wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmread.1.html">geopmread(1) – query platform information</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmsession.1.html">geopmsession(1) – Command line interface for the GEOPM service batch read features</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmwrite.1.html">geopmwrite(1) – modify platform state</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmdpy.7.html">geopmdpy(7) – global extensible open power manager python daemon package</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmpy.7.html">geopmpy(7) – global extensible open power manager python package</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent.3.html">geopm_agent(3) – query information about available agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_ctl.3.html">geopm_ctl(3) – GEOPM runtime control thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_daemon.3.html">geopm_daemon(3) – helpers for GEOPM daemons</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_endpoint.3.html">geopm_endpoint(3) – dynamic policy control for resource management</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_error.3.html">geopm_error(3) – error code descriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_field.3.html">geopm_agent(3) – query information about available agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_fortran.3.html">geopm_fortran(3) – GEOPM fortran interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_hash.3.html">geopm_hash(3) – helper methods for encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_imbalancer.3.html">geopm_imbalancer(3) – set artificial runtime imbalance</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio.3.html">geopm_pio(3) – interfaces to query and modify platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_policystore.3.html">geopm_policystore(3) – GEOPM resource policy store interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_prof.3.html">geopm_prof(3) – application profiling interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_sched.3.html">geopm_sched(3) – interface with Linux scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_time.3.html">geopm_time(3) – helper methods for time</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_topo.3.html">geopm_topo(3) – query platform component topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_version.3.html">geopm_version(3) – GEOPM library version</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AAgent.3.html">geopm::Agent(3) – GEOPM agent plugin interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AAgg.3.html">geopm::Agg(3) – data aggregation functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACNLIOGroup.3.html">geopm::CNLIOGroup(3) – IOGroup for interaction with Compute Node Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACPUActivityAgent.3.html">geopm::CPUActivityAgent(3) – agent for selecting CPU frequency based on CPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACircularBuffer.3.html">geopm::CircularBuffer(3) – generic circular buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AComm.3.html">geopm::Comm(3) – communication abstractions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACpuinfoIOGroup.3.html">geopm::CpuinfoIOGroup(3) – IOGroup for CPU frequency limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ADaemon.3.html">geopm::Daemon(3) – GEOPM daemon helper methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AEndpoint.3.html">geopm::Endpoint(3) – GEOPM endpoint interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AException.3.html">geopm::Exception(3) – custom GEOPM exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AGPUActivityAgent.3.html">geopm::GPUActivityAgent(3) – agent for selecting GPU frequency based on GPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AHelper.3.html">geopm::Helper – common helper methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AIOGroup.3.html">geopm::IOGroup(3) – provides system values and settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMPIComm.3.html">geopm::MPIComm(3) – implementation of Comm using MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMSRIO.3.html">geopm::MSRIO(3) – methods for reading and writing MSRs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMSRIOGroup.3.html">geopm::MSRIOGroup – IOGroup providing MSR-based signals and controls</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMonitorAgent.3.html">geopm::MonitorAgent – agent that enforces no policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APlatformIO.3.html">geopm::PlatformIO(3) – GEOPM platform interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APlatformTopo.3.html">geopm::PlatformTopo(3) – platform topology information</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APluginFactory.3.html">geopm::PluginFactory(3) – abstract factory for plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerBalancer.3.html">geopm::PowerBalancer(3) – balances power according to epoch runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerBalancerAgent.3.html">geopm::PowerBalancerAgent(3) – agent optimizing performance under a power cap</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerGovernor.3.html">geopm::PowerGovernor(3) – enforces a power limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerGovernorAgent.3.html">geopm::PowerGovernorAgent(3) – agent that enforces a power cap</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AProfileIOGroup.3.html">geopm::ProfileIOGroup(3) – IOGroup providing application signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ASampleAggregator.3.html">geopm::SampleAggregator(3) – per-region aggregated signal data</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ASharedMemory.3.html">geopm::SharedMemory(3) – abstractions for shared memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ATimeIOGroup.3.html">geopm::TimeIOGroup(3) – IOGroup providing time signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_report.7.html">geopm_report(7) – GEOPM summary report file</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_cpu_activity.7.html">geopm_agent_cpu_activity(7) – agent for selecting CPU frequency based on CPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_ffnet.7.html">geopm_agent_ffnet(7) – agent for adjusting frequencies based on application behavior</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">geopm_agent_frequency_map(7) – agent for running regions at user selected frequencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#agent-name">Agent Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#policy-parameters">Policy Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#policy-requirements">Policy Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#report-extensions">Report Extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#control-loop-rate">Control Loop Rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_gpu_activity.7.html">geopm_agent_gpu_activity(7) – agent for selecting GPU frequency based on GPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_monitor.7.html">geopm_agent_monitor(7) – agent implementation for aggregating statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_power_balancer.7.html">geopm_agent_power_balancer(7) – agent optimizes performance under a power cap</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_power_governor.7.html">geopm_agent_power_governor(7) – agent enforces a power cap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference.html#doxygen-pages">Doxygen Pages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GEOPM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="reference.html">Reference Manual</a></li>
      <li class="breadcrumb-item active">geopm_agent_frequency_map(7) – agent for running regions at user selected frequencies</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/geopm_agent_frequency_map.7.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geopm-agent-frequency-map-7-agent-for-running-regions-at-user-selected-frequencies">
<h1>geopm_agent_frequency_map(7) – agent for running regions at user selected frequencies<a class="headerlink" href="#geopm-agent-frequency-map-7-agent-for-running-regions-at-user-selected-frequencies" title="Link to this heading"></a></h1>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<p>The frequency map agent adjusts CPU frequency in response to changes
in the application region being executed on each CPU.  The agent
policy can specify a map from a GEOPM region hash to a CPU frequency; see
<a class="reference internal" href="geopm_hash.3.html"><span class="doc">geopm_hash(3)</span></a> for more information about the GEOPM region name
hash function.  When a CPU is executing a region with a hash provided
by the policy, the CPU will operate at the mapped frequency.  The
policy also specifies a default CPU frequency which is applied to all
CPUs running the application while not executing a region described by
the policy map. In addition, the policy can specify a default GPU frequency
which is applied to all GPUs at the board level.</p>
<p>Applying any control algorithm that changes CPU frequency on short
intervals can result in undesirable interactions with the hardware
control algorithm that dynamically selects uncore frequency.  For this
reason, the frequency map agent policy can specify an option to fix the
uncore frequency to a single value while executing the application.
If this option is not specified, the uncore frequency is not
controlled by the agent at all.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This agent can be used to control the application CPUs, optionally
any GPUs, and optionally the uncore to run at fixed frequencies
if no region frequency map is provided.</p>
</div>
</section>
<section id="agent-name">
<h2>Agent Name<a class="headerlink" href="#agent-name" title="Link to this heading"></a></h2>
<p>The agent described in this manual is selected in many geopm
interfaces with the <code class="docutils literal notranslate"><span class="pre">&quot;frequency_map&quot;</span></code> agent name.  This name can be
passed to <a class="reference internal" href="geopmlaunch.1.html"><span class="doc">geopmlaunch(1)</span></a> as the argument to the <code class="docutils literal notranslate"><span class="pre">--geopm-agent</span></code>
option, or the <code class="docutils literal notranslate"><span class="pre">GEOPM_AGENT</span></code> environment variable can be set to this
name (see <a class="reference internal" href="geopm.7.html"><span class="doc">geopm(7)</span></a>).  This name can also be passed to the
<a class="reference internal" href="geopmagent.1.html"><span class="doc">geopmagent(1)</span></a> as the argument to the <code class="docutils literal notranslate"><span class="pre">'-a'</span></code> option.</p>
</section>
<section id="policy-parameters">
<h2>Policy Parameters<a class="headerlink" href="#policy-parameters" title="Link to this heading"></a></h2>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">FREQ_CPU_DEFAULT</span></code>:</dt><dd><p>The operating frequency in units of <em>Hz</em> set by the
agent on CPUs executing the application while the
application is not within a policy-mapped region.
The cores not associated with the application
(including the one running the GEOPM controller)
will run at the default frequency.  This policy
parameter is required and must be specified with a
CPU frequency that is allowed by the system.
Failure to provide this parameter, setting it to an
out of range value or specifying NAN will result in
a runtime error.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FREQ_GPU_DEFAULT</span></code>:</dt><dd><p>The operating frequency in units of <em>Hz</em> is set by the
agent on GPUs. Note that the GPUs not associated with
the application will also have their frequency adjusted.
This policy parameter is optional. Setting the parameter
to an out of range value or setting it on a system with
no GPUs will result in an error.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FREQ_CPU_UNCORE</span></code>:</dt><dd><p>The operating frequency for the uncore clock in units
of <em>Hz</em>.  If specified, the uncore clock will operate
at the fixed frequency provided.  If the parameter is
not specified, or the value provided is NAN, then the
system default range of uncore frequency will be
allowed.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">HASH_0</span></code>:</dt><dd><p>The GEOPM hash of a region name with a mapped CPU
frequency given by the <code class="docutils literal notranslate"><span class="pre">FREQ_0</span></code> policy parameter.  The
region hash values for each application region are
provided in the GEOPM report, and can be generated as
described in <a class="reference internal" href="geopm_hash.3.html"><span class="doc">geopm_hash(3)</span></a>.  In binary code, the
policy values are stored the double precision
representation of the 32-bit integer generated by the hash
function.  When using the <a class="reference internal" href="geopmagent.1.html"><span class="doc">geopmagent(1)</span></a> interface to
generate a policy file, the region name can be provided in
the comma separated list for the <code class="docutils literal notranslate"><span class="pre">-p</span></code> option rather than
the hash of that string. See <a class="reference internal" href="#examples">EXAMPLES</a> section below for
details.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FREQ_0</span></code>:</dt><dd><p>The CPU frequency in units of <em>Hz</em> that will be set when a
CPU is executing the region associated with the <code class="docutils literal notranslate"><span class="pre">HASH_0</span></code>
region hash.  When using the <a class="reference internal" href="geopmagent.1.html"><span class="doc">geopmagent(1)</span></a> command
line interface to generate a policy file, the mapped
frequency will always follow the region name or hash in
the comma separated list for the <code class="docutils literal notranslate"><span class="pre">-p</span></code> option.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">HASH_1</span></code>:</dt><dd><p>The next region hash in the map after <code class="docutils literal notranslate"><span class="pre">HASH_0</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FREQ_1</span></code>:</dt><dd><p>The next CPU frequency in the map after <code class="docutils literal notranslate"><span class="pre">FREQ_0</span></code>.</p>
</dd>
</dl>
<p>…</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">HASH_30</span></code>:</dt><dd><p>There are at most 31 values in the map provided by the policy.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FREQ_30</span></code>:</dt><dd><p>The CPU frequency mapped by <code class="docutils literal notranslate"><span class="pre">HASH_30</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="policy-requirements">
<h2>Policy Requirements<a class="headerlink" href="#policy-requirements" title="Link to this heading"></a></h2>
<p>The frequency map index values can be in the range of 0 to 30,
inclusive. The order of index values does not matter, and gaps in
index values are permitted. Multiple definitions of an index are not
permitted, and multiple mappings of a region are not permitted.  If a
CPU, GPU, or uncore frequency specified in the policy is not allowed
by the system at runtime, an error will occur and an exception will be
raised.</p>
</section>
<section id="report-extensions">
<h2>Report Extensions<a class="headerlink" href="#report-extensions" title="Link to this heading"></a></h2>
<p>The assigned frequency is added to each region’s section of the report
if that region was explicitly assigned a frequency in the policy map.</p>
</section>
<section id="control-loop-rate">
<h2>Control Loop Rate<a class="headerlink" href="#control-loop-rate" title="Link to this heading"></a></h2>
<p>The agent gates the control loop to sample the region hash and control
CPU frequency at 2 millisecond intervals.  If the uncore and/or GPU frequency
is specified in the policy, then it is set at agent start-up time.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<p>Besides the default CPU frequency, default GPU frequency, and uncore
frequency parameters, the policy consists of the map of per-region frequencies
given as pairs of region hash and CPU frequency values.  The recommended way
to generate a policy file for this agent is to use the
<a class="reference internal" href="geopmagent.1.html"><span class="doc">geopmagent(1)</span></a> command line tool.</p>
<p>To create a policy with a default frequency of <em>3 GHz</em>, an uncore
frequency of <em>2 GHz</em>, and a GPU frequency of <em>1.2 GHz</em>  with a map of
<code class="docutils literal notranslate"><span class="pre">&quot;region_1&quot;</span></code> to <em>1.5 GHz</em> and <code class="docutils literal notranslate"><span class="pre">&quot;region_2&quot;</span></code> to <em>2.5 GHz</em> you can specify:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geopmagent</span> <span class="o">-</span><span class="n">a</span> <span class="n">frequency_map</span> <span class="o">-</span><span class="n">p</span> <span class="s1">&#39;3e9,2e9,1.2e9,region_1,1.5e9,region_2,2.5e9&#39;</span>
</pre></div>
</div>
<p>Alternatively you can specify the regions by their hashed values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geopmagent</span> <span class="o">-</span><span class="n">a</span> <span class="n">frequency_map</span> <span class="o">-</span><span class="n">p</span> <span class="s1">&#39;3e9,2e9,1.2e9,0xee12ee15,1.5e9,0xfd421de1,2.5e9&#39;</span>
</pre></div>
</div>
<p>Although the <a class="reference internal" href="geopmagent.1.html"><span class="doc">geopmagent(1)</span></a> is the recommended tool for creating
the json policy string, there is one thing to note about creating the
json string without this tool.  Since json does not support hex
literals, the json must include the hashes in their decimal form. For
example, the above policy json is:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;FREQ_CPU_DEFAULT&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">3e9</span><span class="p">,</span>
<span class="w"> </span><span class="nt">&quot;FREQ_CPU_UNCORE&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2e9</span><span class="p">,</span>
<span class="w"> </span><span class="nt">&quot;FREQ_GPU_DEFAULT&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">1.2e9</span><span class="p">,</span>
<span class="w"> </span><span class="nt">&quot;HASH_0&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3994218005</span><span class="p">,</span>
<span class="w"> </span><span class="nt">&quot;FREQ_0&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5e9</span><span class="p">,</span>
<span class="w"> </span><span class="nt">&quot;HASH_1&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4248968673</span><span class="p">,</span>
<span class="w"> </span><span class="nt">&quot;FREQ_1&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.5e9</span><span class="p">}</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="geopmread.1.html"><span class="doc">geopmread(1)</span></a> command line tool can be useful for learning the
bounds of these system parameters.  The minimum, sticker, and
maximum CPU frequencies are queried as below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geopmread<span class="w"> </span>CPU_FREQUENCY_MIN_AVAIL<span class="w"> </span>board<span class="w"> </span><span class="m">0</span>
<span class="m">1000000000</span>

$<span class="w"> </span>geopmread<span class="w"> </span>CPU_FREQUENCY_STICKER<span class="w"> </span>board<span class="w"> </span><span class="m">0</span>
<span class="m">2100000000</span>

$<span class="w"> </span>geopmread<span class="w"> </span>CPU_FREQUENCY_MAX_AVAIL<span class="w"> </span>board<span class="w"> </span><span class="m">0</span>
<span class="m">3700000000</span>
</pre></div>
</div>
<p>The minimum and maximum GPU frequencies are queried as below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geopmread<span class="w"> </span>GPU_CORE_FREQUENCY_MIN_AVAIL<span class="w"> </span>board<span class="w"> </span><span class="m">0</span>
<span class="m">1000000000</span>

$<span class="w"> </span>geopmread<span class="w"> </span>GPU_CORE_FREQUENCY_MAX_AVAIL<span class="w"> </span>board<span class="w"> </span><span class="m">0</span>
<span class="m">3700000000</span>
</pre></div>
</div>
<p>The minimum, and maximum uncore frequencies are queried as below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>geopmread<span class="w"> </span>MSR::UNCORE_RATIO_LIMIT:MIN_RATIO<span class="w"> </span>board<span class="w"> </span><span class="m">0</span>
<span class="m">1200000000</span>

$<span class="w"> </span>geopmread<span class="w"> </span>MSR::UNCORE_RATIO_LIMIT:MAX_RATIO<span class="w"> </span>board<span class="w"> </span><span class="m">0</span>
<span class="m">2400000000</span>
</pre></div>
</div>
<p>The <strong>geopmagent</strong> and <strong>geopmread</strong> command line tools can be used together
to generate policies.  For example, to create a policy with the
default CPU frequency set to two steps below maximum, the GPU and the uncore
frequency to the maximum, the following commands can be used:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">freq_cpu_default</span><span class="o">=</span><span class="k">$(($(</span>geopmread<span class="w"> </span>CPU_FREQUENCY_MAX_AVAIL<span class="w"> </span>board<span class="w"> </span><span class="m">0</span><span class="k">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="se">\</span>
<span class="w">                  </span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">$(</span>geopmread<span class="w"> </span>CPU_FREQUENCY_STEP<span class="w"> </span>board<span class="w"> </span><span class="m">0</span><span class="k">)))</span>
$<span class="w"> </span><span class="nv">freq_cpu_uncore</span><span class="o">=</span><span class="k">$(</span>geopmread<span class="w"> </span>MSR::UNCORE_RATIO_LIMIT:MAX_RATIO<span class="w"> </span>board<span class="w"> </span><span class="m">0</span><span class="k">)</span>
$<span class="w"> </span><span class="nv">freq_gpu</span><span class="o">=</span><span class="k">$(</span>geopmread<span class="w"> </span>GPU_CORE_FREQUENCY_MAX_AVAIL<span class="w"> </span>board<span class="w"> </span><span class="m">0</span><span class="k">)</span>
$<span class="w"> </span>geopmagent<span class="w"> </span>-a<span class="w"> </span>frequency_map<span class="w"> </span>-p<span class="nv">$freq_cpu_default</span>,<span class="nv">$freq_cpu_uncore</span>,<span class="nv">$freq_gpu</span>
<span class="w">  </span><span class="o">{</span><span class="s2">&quot;FREQ_CPU_DEFAULT&quot;</span>:<span class="w"> </span><span class="m">3500000000</span>,<span class="w"> </span><span class="s2">&quot;FREQ_CPU_UNCORE&quot;</span>:<span class="w"> </span><span class="m">2400000000</span>,<span class="w"> </span><span class="s2">&quot;FREQ_GPU_DEFAULT&quot;</span>:1500000000<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="geopm.7.html"><span class="doc">geopm(7)</span></a>,
<a class="reference internal" href="geopm_agent_power_balancer.7.html"><span class="doc">geopm_agent_power_balancer(7)</span></a>,
<a class="reference internal" href="geopm_agent_power_governor.7.html"><span class="doc">geopm_agent_power_governor(7)</span></a>,
<a class="reference internal" href="geopm%3A%3AAgent.3.html"><span class="doc">geopm::Agent(3)</span></a>,
<a class="reference internal" href="geopm_agent.3.html"><span class="doc">geopm_agent(3)</span></a>,
<a class="reference internal" href="geopmagent.1.html"><span class="doc">geopmagent(1)</span></a>,
<a class="reference internal" href="geopmlaunch.1.html"><span class="doc">geopmlaunch(1)</span></a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geopm_agent_ffnet.7.html" class="btn btn-neutral float-left" title="geopm_agent_ffnet(7) – agent for adjusting frequencies based on application behavior" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="geopm_agent_gpu_activity.7.html" class="btn btn-neutral float-right" title="geopm_agent_gpu_activity(7) – agent for selecting GPU frequency based on GPU compute activity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015 - 2024 Intel Corporation. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>