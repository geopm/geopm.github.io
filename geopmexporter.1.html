

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>geopmexporter(1) – Prometheus exporter for GEOPM metrics &mdash; GEOPM  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/colon_scheme_fix.js?v=ca089989"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="geopmgrid(1) – define control parameter grids" href="geopmgrid.1.html" />
    <link rel="prev" title="geopmendpoint(1) – command line tool for dynamic policy control" href="geopmendpoint.1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GEOPM
              <img src="https://geopm.github.io/images/geopm-logo-clear.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin.html">Admin Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guides.html">User Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="devel.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="reference.html">Reference Manual</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="reference.html#geopm-manual-pages">GEOPM Manual Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="geopm.7.html">geopm(7) – Global Extensible Open Power Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio.7.html">geopm_pio(7) – GEOPM PlatformIO interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_cnl.7.html">geopm_pio_cnl(7) – Signals and controls for Compute Node Linux Board-Level Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_const_config.7.html">geopm_pio_const_config(7) – Signals for ConstConfigIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_cpuinfo.7.html">geopm_pio_cpuinfo(7) – Signals and controls for the CPUInfoIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_dcgm.7.html">geopm_pio_dcgm(7) – IOGroup providing signals and controls for NVIDIA GPUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_levelzero.7.html">geopm_pio_levelzero(7) – IOGroup providing signals and controls for Intel GPUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_msr.7.html">geopm_pio_msr(7) – Signals and controls for Model Specific Registers (MSRs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_nvml.7.html">geopm_pio_nvml(7) – IOGroup providing signals and controls for NVIDIA GPUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_profile.7.html">geopm_pio_profile(7) – Signals and controls for the ProfileIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_service.7.html">geopm_pio_service(7) – Signals and controls for the ServiceIOGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_sst.7.html">geopm_pio_sst(7) – Signals and controls for Intel Speed Select Technology</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_sysfs.7.html">geopm_pio_sysfs(7) – Signals and controls for sysfs attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio_time.7.html">geopm_pio_time(7) – Signals and controls for Time IO Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmaccess.1.html">geopmaccess(1) – Access management for the GEOPM Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmadmin.1.html">geopmadmin(1) – tool for GEOPM system administrators</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmagent.1.html">geopmagent(1) – query agent information and create static policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmbatch.1.html">geopmbatch(1) – Command line interface for the GEOPM batch server</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmbench.1.html">geopmbench(1) – synthetic benchmark application</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmctl.1.html">geopmctl(1) – GEOPM runtime control application</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmendpoint.1.html">geopmendpoint(1) – command line tool for dynamic policy control</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">geopmexporter(1) – Prometheus exporter for GEOPM metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-file">Configuration File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#geopm-summary-method">GEOPM Summary Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prometheus-summary-method">Prometheus Summary Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#systemd-service">Systemd Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exit-status">Exit Status</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geopmgrid.1.html">geopmgrid(1) – define control parameter grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmlaunch.1.html">geopmlaunch(1) – application launch wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmopt.1.html">geopmopt(1) – Bayesian optimization for GEOPM control parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmread.1.html">geopmread(1) – query platform information</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmsession.1.html">geopmsession(1) – sample platform information over time</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmwrite.1.html">geopmwrite(1) – modify platform state</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmdpy.7.html">geopmdpy(7) – global extensible open power manager python daemon package</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopmpy.7.html">geopmpy(7) – global extensible open power manager python package</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent.3.html">geopm_agent(3) – query information about available agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_ctl.3.html">geopm_ctl(3) – GEOPM runtime control thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_daemon.3.html">geopm_daemon(3) – helpers for GEOPM daemons</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_endpoint.3.html">geopm_endpoint(3) – dynamic policy control for resource management</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_error.3.html">geopm_error(3) – error code descriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_field.3.html">geopm_agent(3) – query information about available agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_fortran.3.html">geopm_fortran(3) – GEOPM fortran interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_hash.3.html">geopm_hash(3) – helper methods for encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_imbalancer.3.html">geopm_imbalancer(3) – set artificial runtime imbalance</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_pio.3.html">geopm_pio(3) – interfaces to query and modify platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_policystore.3.html">geopm_policystore(3) – GEOPM resource policy store interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_prof.3.html">geopm_prof(3) – application profiling interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_sched.3.html">geopm_sched(3) – interface with Linux scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_time.3.html">geopm_time(3) – helper methods for time</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_topo.3.html">geopm_topo(3) – query platform component topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_version.3.html">geopm_version(3) – GEOPM library version</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AAgent.3.html">geopm::Agent(3) – GEOPM agent plugin interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AAgg.3.html">geopm::Agg(3) – data aggregation functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACNLIOGroup.3.html">geopm::CNLIOGroup(3) – IOGroup for interaction with Compute Node Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACPUActivityAgent.3.html">geopm::CPUActivityAgent(3) – agent for selecting CPU frequency based on CPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACircularBuffer.3.html">geopm::CircularBuffer(3) – generic circular buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AComm.3.html">geopm::Comm(3) – communication abstractions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ACpuinfoIOGroup.3.html">geopm::CpuinfoIOGroup(3) – IOGroup for CPU frequency limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ADaemon.3.html">geopm::Daemon(3) – GEOPM daemon helper methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AEndpoint.3.html">geopm::Endpoint(3) – GEOPM endpoint interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AException.3.html">geopm::Exception(3) – custom GEOPM exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AGPUActivityAgent.3.html">geopm::GPUActivityAgent(3) – agent for selecting GPU frequency based on GPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AHelper.3.html">geopm::Helper – common helper methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AIOGroup.3.html">geopm::IOGroup(3) – provides system values and settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMPIComm.3.html">geopm::MPIComm(3) – implementation of Comm using MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMSRIO.3.html">geopm::MSRIO(3) – methods for reading and writing MSRs</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMSRIOGroup.3.html">geopm::MSRIOGroup – IOGroup providing MSR-based signals and controls</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AMonitorAgent.3.html">geopm::MonitorAgent – agent that enforces no policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APlatformIO.3.html">geopm::PlatformIO(3) – GEOPM platform interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APlatformTopo.3.html">geopm::PlatformTopo(3) – platform topology information</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APluginFactory.3.html">geopm::PluginFactory(3) – abstract factory for plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerBalancer.3.html">geopm::PowerBalancer(3) – balances power according to epoch runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerBalancerAgent.3.html">geopm::PowerBalancerAgent(3) – agent optimizing performance under a power cap</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerGovernor.3.html">geopm::PowerGovernor(3) – enforces a power limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3APowerGovernorAgent.3.html">geopm::PowerGovernorAgent(3) – agent that enforces a power cap</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3AProfileIOGroup.3.html">geopm::ProfileIOGroup(3) – IOGroup providing application signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ASampleAggregator.3.html">geopm::SampleAggregator(3) – per-region aggregated signal data</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ASharedMemory.3.html">geopm::SharedMemory(3) – abstractions for shared memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm%3A%3ATimeIOGroup.3.html">geopm::TimeIOGroup(3) – IOGroup providing time signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_report.7.html">geopm_report(7) – GEOPM summary report file</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_cpu_activity.7.html">geopm_agent_cpu_activity(7) – agent for selecting CPU frequency based on CPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_ffnet.7.html">geopm_agent_ffnet(7) – agent for adjusting frequencies based on application behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_frequency_balancer.7.html">geopm_agent_frequency_balancer(7) – Agent reduces imbalance across CPU cores</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_frequency_map.7.html">geopm_agent_frequency_map(7) – agent for running regions at user selected frequencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_gpu_activity.7.html">geopm_agent_gpu_activity(7) – agent for selecting GPU frequency based on GPU compute activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_monitor.7.html">geopm_agent_monitor(7) – agent implementation for aggregating statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_power_balancer.7.html">geopm_agent_power_balancer(7) – agent optimizes performance under a power cap</a></li>
<li class="toctree-l3"><a class="reference internal" href="geopm_agent_power_governor.7.html">geopm_agent_power_governor(7) – agent enforces a power cap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference.html#doxygen-pages">Doxygen Pages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GEOPM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="reference.html">Reference Manual</a></li>
      <li class="breadcrumb-item active">geopmexporter(1) – Prometheus exporter for GEOPM metrics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/geopmexporter.1.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geopmexporter-1-prometheus-exporter-for-geopm-metrics">
<h1>geopmexporter(1) – Prometheus exporter for GEOPM metrics<a class="headerlink" href="#geopmexporter-1-prometheus-exporter-for-geopm-metrics" title="Link to this heading"></a></h1>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Link to this heading"></a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>geopmexporter [-h] [-v] [-t PERIOD] [-p PORT] [-i CONFIG_PATH] [--summary SUMMARY] [-c CERTFILE] [-k KEYFILE] [--insecure-http]
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<p>Prometheus exporter client that publishes telemetry read through GEOPM.  By
default, this exports all power, energy, frequency and thermal metrics that are
available through GEOPM on the platform.  By using the <code class="docutils literal notranslate"><span class="pre">-i</span></code> option, the
exporter may be configured to publish any set of available signals.</p>
<p>The metrics are sampled periodically through the GEOPM PlatformIO batch
interface.  The period of these samples defaults to 100 ms, but the user may
override this with the <code class="docutils literal notranslate"><span class="pre">-t</span></code> option.  The values measured are summarized when
the Prometheus server scrapes the data published by the exporter.  These data
are published on port 8000 by default, but the user may override this with the
<code class="docutils literal notranslate"><span class="pre">-p</span></code> option.</p>
<section id="options">
<h3>Options<a class="headerlink" href="#options" title="Link to this heading"></a></h3>
<dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p id="help-option">Print help message and exit</p>
</dd>
<dt><kbd><span class="option">-v</span>, <span class="option">--version</span></kbd></dt>
<dd><p id="version-option">Print version and exit</p>
</dd>
<dt><kbd><span class="option">-t</span>, <span class="option">--period</span></kbd></dt>
<dd><p id="period-period-option">Sample period for fast loop in seconds. Default: 0.1</p>
</dd>
<dt><kbd><span class="option">-p</span>, <span class="option">--port</span></kbd></dt>
<dd><p id="port-port-option">Port to publish Prometheus metrics. Default: 8000</p>
</dd>
<dt><kbd><span class="option">-i</span>, <span class="option">--signal-config</span></kbd></dt>
<dd><p id="signalconfig-config-path-option">Signal configuration file path, specify “-” to use standard input.  The
format of the configuration file is described below.</p>
</dd>
<dt><kbd><span class="option">--summary</span></kbd></dt>
<dd><p id="summary-summary-option">Summary method, one of “geopm”, or “prometheus”. Default: geopm</p>
</dd>
<dt><kbd><span class="option">-c</span>, <span class="option">--certfile</span></kbd></dt>
<dd><p id="certfile-certfile-option">Server certificate used during the TLS handshake.</p>
</dd>
<dt><kbd><span class="option">-k</span>, <span class="option">--keyfile</span></kbd></dt>
<dd><p id="keyfile-keyfile-option">Server certificate private key.</p>
</dd>
<dt><kbd><span class="option">--insecure-http</span></kbd></dt>
<dd><p id="insecure-http-option">Use HTTP instead of HTTPS to export metrics over TCP/IP.</p>
</dd>
</dl>
</section>
</section>
<section id="configuration-file">
<h2>Configuration File<a class="headerlink" href="#configuration-file" title="Link to this heading"></a></h2>
<p>The input file is a list of read requests each on its own line.  A request for
reading is made up of three strings separated by white space. The first string
is the signal name, the second string is the domain name, and the third string
is the domain index.  Provide the “<code class="docutils literal notranslate"><span class="pre">*</span></code>” character as the third string to
request all domains available on the system.</p>
</section>
<section id="geopm-summary-method">
<h2>GEOPM Summary Method<a class="headerlink" href="#geopm-summary-method" title="Link to this heading"></a></h2>
<p>There are two options available for summarizing the statistics for the
Prometheus exporter.  The default option is to use the GEOPM <code class="docutils literal notranslate"><span class="pre">StatsCollector</span></code>
interface to summarize sampled values.  This is a high performance option that
provides fine grained summary statistics through a Prometheus Gauge metric
interface:</p>
<dl>
<dt>count:</dt><dd><p>Number of samples recorded since last Prometheus server scrape</p>
</dd>
<dt>first:</dt><dd><p>First value sampled after last Prometheus server scrape</p>
</dd>
<dt>last:</dt><dd><p>Most recently sampled value prior to Prometheus server scrape</p>
</dd>
<dt>min:</dt><dd><p>Smallest sampled value since last Prometheus server scrape</p>
</dd>
<dt>max:</dt><dd><p>Largest sampled value since last Prometheus server scrape</p>
</dd>
<dt>mean:</dt><dd><p>Sum of all samples divided by the number of samples since last Prometheus
server scrape</p>
</dd>
<dt>std:</dt><dd><p>Sample standard deviation represented by the following sum over samples:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">sqrt(sum((x_i</span> <span class="pre">-</span> <span class="pre">m)</span> <span class="pre">^</span> <span class="pre">2)</span> <span class="pre">/</span> <span class="pre">(n</span> <span class="pre">-</span> <span class="pre">1))</span></code></p>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">m</span></code> is the mean, <code class="docutils literal notranslate"><span class="pre">x_i</span></code> are the samples, and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of
samples</p>
</dd>
</dl>
</section>
<section id="prometheus-summary-method">
<h2>Prometheus Summary Method<a class="headerlink" href="#prometheus-summary-method" title="Link to this heading"></a></h2>
<p>When the user specifies the <code class="docutils literal notranslate"><span class="pre">--summary</span> <span class="pre">prometheus</span></code> command line option the
<code class="docutils literal notranslate"><span class="pre">Summary</span></code> and <code class="docutils literal notranslate"><span class="pre">Counter</span></code> metrics built into Prometheus are used to aggregate
samples over time.  In this way the batch of signals read from the GEOPM is used
to update a <code class="docutils literal notranslate"><span class="pre">Summary</span></code> metric for GEOPM signals with variable behavior, or a
<code class="docutils literal notranslate"><span class="pre">Counter</span></code> metric for signals with monotone behavior.  Each metric provides
slightly different statistics for the Prometheus server on the port opened by
<code class="docutils literal notranslate"><span class="pre">geopmexporter</span></code>.  The <code class="docutils literal notranslate"><span class="pre">Summary</span></code> metric exports the <strong>count</strong> and <strong>sum</strong>
statistics, where as the <code class="docutils literal notranslate"><span class="pre">Counter</span></code> metric exports the <strong>count</strong> and <strong>total</strong>
statistics.  GEOPM calls into the Prometheus metrics through a Python interface.
This means that the quartile metrics are not currently supported for <code class="docutils literal notranslate"><span class="pre">Summary</span></code>
metrics. See the Prometheus documentation for more information about the
<code class="docutils literal notranslate"><span class="pre">Summary</span></code> and <code class="docutils literal notranslate"><span class="pre">Counter</span></code> metrics and the statistics that they export to the
Prometheus server.</p>
<p>Using Prometheus to aggregate samples provides an easy method to compare against
the GEOPM <code class="docutils literal notranslate"><span class="pre">StatsCollector</span></code> method for summary.  Using the <code class="docutils literal notranslate"><span class="pre">--summary</span> <span class="pre">prometheus</span></code>
mode provides a more course grained view of the metrics gathered, and also tends
to have a higher system overhead.</p>
</section>
<section id="systemd-service">
<h2>Systemd Service<a class="headerlink" href="#systemd-service" title="Link to this heading"></a></h2>
<p>One simple way to manage the GEOPM Prometheus exporter process is to create a
systemd service.  To use <code class="docutils literal notranslate"><span class="pre">geopmexporter</span></code> with systemd create a systemd unit
configuration file called <code class="docutils literal notranslate"><span class="pre">geopmexporter.service</span></code> with the following content:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">Prometheus GEOPM Exporter</span>
<span class="na">StartLimitIntervalSec</span><span class="o">=</span><span class="s">0</span>
<span class="na">StartLimitBurst</span><span class="o">=</span><span class="s">3</span>
<span class="na">Wants</span><span class="o">=</span><span class="s">geopm.service</span>
<span class="na">After</span><span class="o">=</span><span class="s">geopm.service</span>
<span class="na">After</span><span class="o">=</span><span class="s">network-online.target</span>

<span class="k">[Service]</span>
<span class="na">Environment</span><span class="o">=</span><span class="s">PYTHONUNBUFFERED=true</span>
<span class="na">User</span><span class="o">=</span><span class="s">prometheus</span>
<span class="na">Group</span><span class="o">=</span><span class="s">prometheus</span>
<span class="na">Type</span><span class="o">=</span><span class="s">simple</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/usr/bin/geopmexporter</span>
<span class="na">SyslogIdentifier</span><span class="o">=</span><span class="s">geopmexporter</span>
<span class="na">Restart</span><span class="o">=</span><span class="s">always</span>
<span class="na">RestartSec</span><span class="o">=</span><span class="s">1</span>
<span class="na">StartLimitInterval</span><span class="o">=</span><span class="s">0</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span>
</pre></div>
</div>
<p>Execute the commands below to install this systemd service and enable it.  These
commands create a user and group called <code class="docutils literal notranslate"><span class="pre">prometheus</span></code> which will run the
service, the systemd unit file described above is installed, and then systemd is
notified of the new service.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>groupadd<span class="w"> </span>--system<span class="w"> </span>prometheus
sudo<span class="w"> </span>useradd<span class="w"> </span>-s<span class="w"> </span>/sbin/nologin<span class="w"> </span>--system<span class="w"> </span>-g<span class="w"> </span>prometheus<span class="w"> </span>prometheus
sudo<span class="w"> </span>cp<span class="w"> </span>geopmexporter.service<span class="w"> </span>/etc/systemd/system/
sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>geopmexporter
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>geopmexporter
</pre></div>
</div>
<p>Note to customize the exporter to fit the needs of your system, the
<code class="docutils literal notranslate"><span class="pre">ExecStart</span></code> command in the systemd unit file may be modified with any of the
command line options described in the options section above.</p>
</section>
<section id="exit-status">
<h2>Exit Status<a class="headerlink" href="#exit-status" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">geopmexporter</span></code> command will return 0 upon success and -1 on failure.  For
all failures, an error message describing the failure will be printed.  Setting
the <code class="docutils literal notranslate"><span class="pre">GEOPM_DEBUG</span></code> environment variable will enable more verbose error
messages.</p>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="geopm.7.html"><span class="doc">geopm(7)</span></a>,
<a class="reference internal" href="geopmread.1.html"><span class="doc">geopmread(1)</span></a>,
<a class="reference internal" href="geopmwrite.1.html"><span class="doc">geopmwrite(1)</span></a>,
<a class="reference internal" href="geopmsession.1.html"><span class="doc">geopmsession(1)</span></a>,
<a class="reference internal" href="geopm_pio.7.html"><span class="doc">geopm_pio(7)</span></a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geopmendpoint.1.html" class="btn btn-neutral float-left" title="geopmendpoint(1) – command line tool for dynamic policy control" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="geopmgrid.1.html" class="btn btn-neutral float-right" title="geopmgrid(1) – define control parameter grids" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015 - 2025 Intel Corporation. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>