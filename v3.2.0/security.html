

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Service Security &mdash; GEOPM  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Service Clients" href="client.html" />
    <link rel="prev" title="GEOPM Service" href="service_readme.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GEOPM
              <img src="https://geopm.github.io/images/geopm-logo-clear.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guides.html">User Guides</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="service.html">User Guide for GEOPM Service</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="service_readme.html">GEOPM Service</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Service Security</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#high-level-security-objectives">High-Level Security Objectives</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-interfaces">Secure Interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-software-dependencies">Secure Software Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#protected-assets">Protected Assets</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attack-surface">Attack Surface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#security-threats">Security Threats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="admin.html">Service Administrators</a></li>
<li class="toctree-l3"><a class="reference internal" href="client.html">Service Clients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="runtime.html">User Guide for GEOPM Runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="frequency_guide.html">User Guide for Frequency Control</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="devel.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GEOPM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="user_guides.html">User Guides</a></li>
          <li class="breadcrumb-item"><a href="service.html">User Guide for GEOPM Service</a></li>
      <li class="breadcrumb-item active">Service Security</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/security.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="service-security">
<h1>Service Security<a class="headerlink" href="#service-security" title="Link to this heading"></a></h1>
<p>This document explains the objectives, mechanisms, assets and threats
associated with the design of the GEOPM Service security architecture. It
can be beneficial to system administrators, developers, and users who wish
to understand how the service provides security.</p>
<section id="high-level-security-objectives">
<h2>High-Level Security Objectives<a class="headerlink" href="#high-level-security-objectives" title="Link to this heading"></a></h2>
<p>The GEOPM Service functions as a secure gateway to privileged hardware
features. The security expectations of system administrators deploying
and configuring the service, as outlined in the GEOPM documentation, are
detailed in this section.</p>
<section id="fine-grained-access-management-for-hardware-features">
<h3>Fine-Grained Access Management for Hardware Features<a class="headerlink" href="#fine-grained-access-management-for-hardware-features" title="Link to this heading"></a></h3>
<p>The GEOPM Service provides a user gateway to privileged system software
interfaces. Typically, these interfaces have Linux mechanisms that allow
administrators to grant or deny user access. The service enhances other
Linux security mechanisms by integrating fine-grained access management,
easy extension, and an optional high-performance interface—improving upon
what typically are coarse-grained, less performant, or harder-to-extend
alternatives.</p>
<p>It’s possible to enable certain features of existing device
drivers for end users by altering file permissions, but
this doesn’t allow for the filtering of driver features. This
solution may often be insufficient due to Linux <a class="reference external" href="https://man7.org/linux/man-pages/man7/capabilities.7.html">capabilities(7)</a> requirements.</p>
<p>Granting Linux capabilities to a helper command-line
tool or adding a command-line tool to the <a class="reference external" href="https://man7.org/linux/man-pages/man5/sudoers.5.html">sudoers(5)</a> configuration is
a common method of enabling specific secure features. These command-line
tools may require independent security review and usually don’t deliver
high-performance programmatic solutions.</p>
<p>High-performance security solutions often necessitate alterations to
Linux kernel code either through a specialized driver or via <a class="reference external" href="https://ebpf.io">eBPF</a> program insertion. They require custom tools
integrated into the Linux kernel, requiring independent security reviews
by administrators and specialized kernel or eBPF development knowledge
from developers and security experts. Identifying errors and security
vulnerabilities in these filtering and device driver implementations can
be particularly challenging.</p>
<p>The GEOPM Service offers fine-grained access management to individual
hardware features for various hardware interfaces. System administrators can
grant access to each unique feature provided by a system software interface
to individual users, Unix user groups, or all system users. Expansion of
hardware interfaces is possible via the <code class="docutils literal notranslate"><span class="pre">IOGroup</span></code> C++ plugin interface.</p>
<p>“Signals” refer to hardware features that can be read and are mapped to
a particular string name. Writable hardware features, called “controls,”
are also mapped to a specific string name. These signals and controls
are represented as double-precision floating-point numbers in SI units
and are combined with a hardware domain and domain index for requests to
read signals or write controls. The hardware domain specifies the hardware
component type, while the domain index identifies the exact component where
the request applies.</p>
<p>The GEOPM Service adheres to a “Secure by Default” design, which means no user
access to signals or controls is provided until a system administrator grants
it. All signal and control options are documented, and their descriptions
include their security implications. The <code class="docutils literal notranslate"><span class="pre">geopmaccess</span></code> command-line tool
enables system administrators to query signal and control descriptions and
manage user access to each feature based on their name.</p>
</section>
<section id="restoring-control-configuration-after-a-writing-session-ends">
<h3>Restoring Control Configuration After a Writing Session Ends<a class="headerlink" href="#restoring-control-configuration-after-a-writing-session-ends" title="Link to this heading"></a></h3>
<p>Users cannot make persistent changes to hardware settings through
the GEOPM Service; any configuration alterations last only for
the duration of the writing PID’s process session. To understand
the Linux process session interface more, refer to the <a class="reference external" href="https://man7.org/linux/man-pages/man2/setsid.2.html">setsid(2)</a> man page, which
explains that a process session is usually linked to a controlling terminal.</p>
<p>The GEOPM Service supports this feature by saving all control configuration
settings to disk before enabling a user session to write. After the user’s
write session terminates, all settings are restored to their original
state. The saved state is stored in the directory <code class="docutils literal notranslate"><span class="pre">/run/geopm/SAVE_FILES</span></code>.</p>
<p>Note that all configuration settings are restored, regardless of whether
they were modified during the session through the service.</p>
</section>
<section id="one-geopm-writing-session-allowed-at-any-time">
<h3>One GEOPM Writing Session Allowed at Any Time<a class="headerlink" href="#one-geopm-writing-session-allowed-at-any-time" title="Link to this heading"></a></h3>
<p>The GEOPM Service only supports one active writing user session at a time.
This restriction supports the save/restore methodology explained in the
previous section. The write lock enabling this mutual exclusion is tied
to the Unix “process session leader” PID of the requesting process. If
this session leader PID doesn’t refer to an active process, the lock
is associated with the requesting process PID. Otherwise, any PID within
the requesting Unix process session can write via the GEOPM Service for
the entire process session leader PID lifespan.</p>
</section>
<section id="providing-a-low-latency-interface">
<h3>Providing a Low-Latency Interface<a class="headerlink" href="#providing-a-low-latency-interface" title="Link to this heading"></a></h3>
<p>The GEOPM Service offers a batch interface letting users configure
a server process. The batch server process is forked by <code class="docutils literal notranslate"><span class="pre">geopmd</span></code>,
the primary GEOPM Service daemon process started by <a class="reference external" href="https://man7.org/linux/man-pages/man1/systemd.1.html">systemd(1)</a>.  The user can
configure the batch server with an array of requests via DBus. Access
permissions are checked when initiating the server, which will only be
forked if the client has authorization for all array requests.  The batch
server establishes one or two inter-process shared memory regions to
communicate with the client — one for user interface signal readings,
and another (if requested) to provide the user interface control for
writing.  The client makes requests to read, write, or quit through
a FIFO channel, connecting them to the batch server. A second FIFO
communicates to the client when requests are complete. These FIFOs are
opened in <code class="docutils literal notranslate"><span class="pre">/run/geopm</span></code>, which systemd sets up by default as a <a class="reference external" href="https://man7.org/linux/man-pages/man5/tmpfs.5.html">tmpfs(5)</a>.</p>
</section>
<section id="securing-restart-of-the-geopmd-daemon-process">
<h3>Securing Restart of the <code class="docutils literal notranslate"><span class="pre">geopmd</span></code> Daemon Process<a class="headerlink" href="#securing-restart-of-the-geopmd-daemon-process" title="Link to this heading"></a></h3>
<p>All states required to uphold the GEOPM Service’s security guarantees
are stored securely on disk (for more details, see <a class="reference internal" href="#file-usage-configuration"><span class="std std-ref">File Usage/Configuration</span></a>). The <code class="docutils literal notranslate"><span class="pre">geopmd</span></code> daemon process reads this information
from the disk on startup, allowing the service to recover cleanly in the
event the daemon process ends prematurely. The systemd Linux service offers
a restart of the daemon process through a configuration option provided
by the GEOPM Service. The service may be restarted immediately, with the
option to retry twice in quick succession if required. The first attempt
resets the environment for the second restart.</p>
</section>
</section>
<section id="secure-interfaces">
<h2>Secure Interfaces<a class="headerlink" href="#secure-interfaces" title="Link to this heading"></a></h2>
<p>Users can access privileged system resources through the GEOPM Service via the
GEOPM DBus interface published on the system bus at <code class="docutils literal notranslate"><span class="pre">io.github.geopm</span></code>. This
interface can facilitate the creation of a batch server. The batch server’s
access rights are verified before it’s created, and the user can then interact
with it via faster mechanisms than those provided by DBus. In particular,
the user interacts with the batch server over inter-process shared memory
and FIFO special files, created in <code class="docutils literal notranslate"><span class="pre">/run/geopm</span></code>.</p>
<p>The DBus interface offers a security layer used throughout Linux services
to confirm the user identity of daemon process requests. The GEOPM Service
relies on the systemd DBus interface to provide PID, UID, and GID details
of the requesting client. These identifiers are then used with standard
system calls to enforce access permissions defined by a system administrator.</p>
</section>
<section id="secure-software-dependencies">
<h2>Secure Software Dependencies<a class="headerlink" href="#secure-software-dependencies" title="Link to this heading"></a></h2>
<p>The GEOPM Service relies on external software packages to support its security
objectives. These packages allow secure use of the DBus interface to systemd,
providing standard methods for validating JSON data.</p>
<ol class="arabic simple">
<li><p>GEOPM Service DBus Interface</p>
<ol class="loweralpha simple">
<li><p>dasbus &gt;= 1.6</p></li>
<li><p>libsystemd.so / systemd service &gt; 234</p></li>
<li><p>PyGObject &gt;= 3.34.0</p></li>
</ol>
</li>
<li><p>GEOPM Service Input/Output Validation</p>
<ol class="loweralpha simple">
<li><p>jsonschema &gt;= 2.6.0</p></li>
<li><p>json11 &gt;= 1.0.0</p></li>
</ol>
</li>
</ol>
</section>
<section id="protected-assets">
<h2>Protected Assets<a class="headerlink" href="#protected-assets" title="Link to this heading"></a></h2>
<p>The GEOPM Service operates as a secure passageway to privileged hardware
interfaces, including power and energy management features and performance
counter readings. These secure system software interfaces, accessible
through the GEOPM Service, are explained in this section. The interfaces
can also be expanded using the GEOPM IOGroup plugin interface.</p>
<p>For system administrators to manage access to hardware features, the GEOPM
service provides the <code class="docutils literal notranslate"><span class="pre">geopmaccess</span></code> command line interface. The interface
is expected to be a reliable and secure means of managing users’ access
rights to the assets discussed in this section. User privacy maintenance,
ensuring that the GEOPM service interactions with the client are not visible
to other users, is also a security priority.</p>
<section id="model-specific-register-device-driver">
<h3>Model-Specific Register Device Driver<a class="headerlink" href="#model-specific-register-device-driver" title="Link to this heading"></a></h3>
<p>The GEOPM Service can function as a gateway to the x86 Model-Specific Register
device driver, <a class="reference external" href="https://man7.org/linux/man-pages/man4/msr.4.html">msr(4)</a>,
loaded as <code class="docutils literal notranslate"><span class="pre">/dev/cpu/*/msr</span></code> devices. There are various features accessible
through the MSR device driver, and the GEOPM Service allows usage of a subset
of these features focused on energy and power management and performance
monitoring. Examples include reading instruction counters or setting CPU
core operating frequency limits.</p>
<p>As direct access to the MSR driver may enable users to gain
unauthorized information about processes they don’t own or
influence system performance for other users, it’s restricted. Using
the MSR driver requires the <code class="docutils literal notranslate"><span class="pre">CAP_SYS_RAWIO</span></code> Linux <a class="reference external" href="https://man7.org/linux/man-pages/man7/capabilities.7.html">capability</a>.</p>
<p>The GEOPM Service’s access management system enables a system
administrator to control which features can be accessed through the MSR
driver. The service also prevents permanent changes to the MSR driver. As
such, administrators may want to provide MSR access through the GEOPM
Service to processes that lack the <code class="docutils literal notranslate"><span class="pre">CAP_SYS_RAWIO</span></code> Linux <a class="reference external" href="https://man7.org/linux/man-pages/man7/capabilities.7.html">capability</a>.</p>
</section>
<section id="intel-speed-select-device-driver">
<h3>Intel Speed Select Device Driver<a class="headerlink" href="#intel-speed-select-device-driver" title="Link to this heading"></a></h3>
<p>The GEOPM Service can act as a gateway to the Intel Speed Select device
driver, loaded as the <code class="docutils literal notranslate"><span class="pre">/dev/isst_interface</span></code> device. This driver offers a
broad set of capabilities introduced with the 3rd generation Xeon Scalable
server processor.</p>
<p><a class="reference external" href="https://www.kernel.org/doc/html/latest/admin-guide/pm/intel-speed-select.html">https://www.kernel.org/doc/html/latest/admin-guide/pm/intel-speed-select.html</a></p>
<p>The specific features supported through the GEOPM Service are the <a class="reference external" href="https://www.kernel.org/doc/html/latest/admin-guide/pm/intel-speed-select.html#intel-r-speed-select-technology-core-power-intel-r-sst-cp">SST-CP</a>
and <a class="reference external" href="https://www.kernel.org/doc/html/latest/admin-guide/pm/intel-speed-select.html#intel-r-speed-select-technology-turbo-frequency-intel-r-sst-tf">SST-TF</a>
features. Use of the <code class="docutils literal notranslate"><span class="pre">isst_interface</span></code> device driver necessitates the Linux
<a class="reference external" href="https://man7.org/linux/man-pages/man7/capabilities.7.html">capability</a>
of <code class="docutils literal notranslate"><span class="pre">CAP_SYS_ADMIN</span></code> because changes may influence system performance for
other users. The ISST interface can also alter the hardware characteristics
reported by the Linux kernel, including the number of cores, base frequency,
and achievable turbo frequencies.</p>
</section>
<section id="xe-and-i915-drm-device-drivers">
<h3>Xe and i915 DRM Device Drivers<a class="headerlink" href="#xe-and-i915-drm-device-drivers" title="Link to this heading"></a></h3>
<p>The GEOPM Service can function as a gateway to the Xe and i915 DRM (Direct
Rendering Manager) device drivers, which are loaded as part of the Linux
kernel. These drivers provide access to GPU-related metrics and controls,
such as energy consumption, power limits, and performance monitoring. The
GEOPM Service enables fine-grained access to these features, allowing system
administrators to control which signals and controls are exposed to users.
For more information, see the <a class="reference external" href="https://www.kernel.org/doc/html/next/gpu/driver-uapi.html#drm-xe-uapi">Xe documentation</a> and
the <a class="reference external" href="https://www.kernel.org/doc/html/next/gpu/i915.html">i915 documentation</a>.</p>
</section>
<section id="cpufreq-device-driver">
<h3>Cpufreq Device Driver<a class="headerlink" href="#cpufreq-device-driver" title="Link to this heading"></a></h3>
<p>The GEOPM Service can act as a gateway to the cpufreq device driver, which
provides access to CPU frequency scaling metrics and controls. This includes
signals for minimum and maximum CPU frequencies, as well as controls for
setting frequency limits. The cpufreq driver is essential for managing CPU
power and performance. For more information, see the <a class="reference external" href="https://docs.kernel.org/admin-guide/pm/cpufreq.html">cpufreq documentation</a>.</p>
</section>
<section id="powercap-device-driver">
<h3>Powercap Device Driver<a class="headerlink" href="#powercap-device-driver" title="Link to this heading"></a></h3>
<p>The GEOPM Service can also interface with the powercap device driver, which
provides access to power capping and energy monitoring features. This includes
signals for power consumption and energy usage, as well as controls for
setting power limits. The powercap driver is critical for managing system
power efficiency. For more information, see the <a class="reference external" href="https://www.kernel.org/doc/html/next/power/powercap/powercap.html">powercap documentation</a>.</p>
</section>
<section id="levelzero-sysman-library-interface">
<h3>LevelZero Sysman Library Interface<a class="headerlink" href="#levelzero-sysman-library-interface" title="Link to this heading"></a></h3>
<p>The LevelZero sysman library interface allows users to monitor and control
Intel GPU devices. These signals and controls include setting GPU operating
frequency bounds and reading performance counters from GPU devices. Access
to the LevelZero sysman interface is restricted as it provides the ability
to alter system performance and direct access to hardware metrics that
reflect user activity.</p>
</section>
<section id="nvidia-nvml-device-management-library-interface">
<h3>Nvidia NVML Device Management Library Interface<a class="headerlink" href="#nvidia-nvml-device-management-library-interface" title="Link to this heading"></a></h3>
<p>The NVML library interface allows users to monitor and control Nvidia GPU
devices. Controls and monitors for setting GPU operating frequency bounds
and reading performance counters from GPU devices are available. Access to
some NVML library interfaces is restricted, but some restrictions may be
relaxed based on settings enabled by a system administrator.</p>
</section>
<section id="user-data">
<h3>User Data<a class="headerlink" href="#user-data" title="Link to this heading"></a></h3>
<p>Any interaction between each client and the GEOPM Service is considered
private information and should be protected. Therefore, unprivileged users
should not be able to observe the calls, inputs, or outputs made to the
GEOPM Service by other users.</p>
</section>
</section>
<section id="attack-surface">
<h2>Attack Surface<a class="headerlink" href="#attack-surface" title="Link to this heading"></a></h2>
<p>This section outlines the interfaces that must be secure to maintain the
security requirements of the GEOPM Service.</p>
<section id="system-files">
<h3>System Files<a class="headerlink" href="#system-files" title="Link to this heading"></a></h3>
<p>The state used to manage access permissions, track active sessions, and store
control settings for reset is maintained in system files. Files controlling
access permissions are in the <code class="docutils literal notranslate"><span class="pre">/etc/geopm</span></code> directory. Information necessary
to support active user sessions is stored in <code class="docutils literal notranslate"><span class="pre">/run/geopm</span></code>. Protecting
these files is crucial to the GEOPM Service security model. Generally,
these files are only accessible by root and are modified by interacting with
GEOPM Service interfaces or running GEOPM Service command-line tools such as
<code class="docutils literal notranslate"><span class="pre">geopmaccess</span></code>.</p>
</section>
<section id="inter-process-shared-memory">
<h3>Inter-Process Shared Memory<a class="headerlink" href="#inter-process-shared-memory" title="Link to this heading"></a></h3>
<p>The batch server interface of the GEOPM Service uses POSIX inter-process
shared memory to communicate with user processes. For every opened batch
session by a user process, one or two shared memory regions are created
for communication. Protecting these shared system resources is a critical
aspect of our security model. Unauthorized access to these shared memory
regions by a user other than the client may lead to privilege escalation
and disruption of the administrative access lists.</p>
</section>
<section id="fifo-special-files">
<h3>FIFO Special Files<a class="headerlink" href="#fifo-special-files" title="Link to this heading"></a></h3>
<p>To support GEOPM Service’s batch server features, FIFO special files are
created in the <code class="docutils literal notranslate"><span class="pre">/run/geopm</span></code> directory, working in tandem with inter-process
shared memory. These FIFOs act as synchronization mechanisms, facilitating
notifications between the client and server regarding shared memory data
updates. Unauthorized access to these files might result in batch server or
client process deadlocks and potential exposure of client session request
details.</p>
</section>
<section id="systemd-dbus-interface">
<h3>Systemd DBus Interface<a class="headerlink" href="#systemd-dbus-interface" title="Link to this heading"></a></h3>
<p>GEOPM Service leverages the systemd DBus, a standardized
Linux interface for secure service communication. The <a class="reference external" href="https://man7.org/linux/man-pages/man3/sd-bus.3.html">sd-bus(3)</a> interface of the
Linux systemd service enables secure request and result exchanges with the
GEOPM Service, as well as the identification of client request origins. On the
server side, the GEOPM DBus interface implementation utilizes the <a class="reference external" href="https://dasbus.readthedocs.io/en/stable/index.html" title="(in dasbus)"><span class="xref std std-doc">dasbus</span></a> and <a class="reference external" href="https://pygobject.gnome.org/index.html" title="(in PyGObject)"><span class="xref std std-doc">PyGObject</span></a> Python modules. In
contrast, the client side employs <code class="docutils literal notranslate"><span class="pre">libsystemd.so</span></code> with the <a class="reference external" href="https://man7.org/linux/man-pages/man3/sd-bus.3.html">sd-bus(3)</a> interface. The GEOPM
Service trusts these standard Linux tools for a reliable and secure interface.</p>
</section>
<section id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Link to this heading"></a></h3>
<p>GEOPM prioritizes comprehensive logging to ensure traceability for system
administrators regarding user activities. Emphasis is placed on recording
security-sensitive events, limiting excessive logging, protecting private
information, and maintaining log integrity. The GEOPM Service can write logs
via the <code class="docutils literal notranslate"><span class="pre">dasbus</span></code> provided service. Typically, logs are available through
the systemd-supported journalctl command (e.g., <code class="docutils literal notranslate"><span class="pre">journalctl</span> <span class="pre">-u</span> <span class="pre">geopm</span></code>)
or by inspecting <code class="docutils literal notranslate"><span class="pre">/var/log/messages</span></code>, though access might vary depending
on system configuration. Additionally, any errors arising from the setup or
usage of secure configuration files will be logged. More details on these
secure files can be found at <a class="reference internal" href="#system-files"><span class="std std-ref">System Files</span></a>.</p>
</section>
</section>
<section id="security-threats">
<h2>Security Threats<a class="headerlink" href="#security-threats" title="Link to this heading"></a></h2>
<p>This section outlines potential threats to the GEOPM Service’s security,
detailing how each threat might exploit vulnerabilities and the measures
taken to fortify against them.</p>
<section id="malicious-input-or-private-output">
<h3>Malicious Input or Private Output<a class="headerlink" href="#malicious-input-or-private-output" title="Link to this heading"></a></h3>
<p>Unprivileged user-accessible GEOPM Service interfaces represent potential
threat vectors. All user inputs are scrutinized to prevent the use of harmful
or incorrect data that might compromise or misconfigure the system. Similarly,
all outputs are checked to prevent the disclosure of private or malicious
data. Two main interfaces are available to end users: the <code class="docutils literal notranslate"><span class="pre">io.github.geopm</span></code>
DBus interface via systemd and the batch server interface accessible through
inter-process shared memory and FIFO special files in <code class="docutils literal notranslate"><span class="pre">/run/geopm</span></code>.</p>
</section>
<section id="file-usage-configuration">
<h3>File Usage/Configuration<a class="headerlink" href="#file-usage-configuration" title="Link to this heading"></a></h3>
<p>As GEOPM reads and writes configuration files to disk, it is important
to validate that the file usage is done as securely as possible. This
includes verifying an input file is not a symbolic link to an
unintended resource, verifying that all temporary files are cleaned up
properly, and that the temporary files and directories that are used
do not have excessive permissions.</p>
<p>The GEOPM Service utilizes files on disk to support several behaviors
including facilitating user/group access to privileged
signals/controls, storing state information about in-progress client
sessions, and saving the initial state of hardware controls so that
any control changes may be reverted. GEOPM utilizes temporary files
and move semantics to ensure that files written to the secure
locations previously described are complete and have valid data.</p>
<p>GEOPM mitigates threats in this space by performing several checks on
any files/directories used for input. Note that there are no user
facing APIs provided by the GEOPM Service that take paths as
input. All directory paths used in the GEOPM Service are statically
defined in the source code.</p>
<p>A secure API for dealing with files and directories resides in
<a class="reference external" href="https://github.com/geopm/geopm/blob/dev/geopmdpy/geopmdpy/system_files.py">system_files.py</a>.
The functions that match the pattern system_files.secure_*() are the
only interfaces called by the GEOPM Service to access files located in
<code class="docutils literal notranslate"><span class="pre">/etc</span></code> and <code class="docutils literal notranslate"><span class="pre">/run</span></code>. These secure functions are used to make
directories and any input or output to these system files.</p>
<p>When making directories, if the path already exists checks are
performed to ensure: the path is a regular directory, the path is not
a link, the path is accessible by the caller, the path is owned by the
calling process UID/GID, and the permissions on the directory are set
to the right permissions (chosen to be as restrictive as possible). If
the path is determined to be insecure, the existing path is renamed to
indicate it is invalid and preserved for later auditing. In this case
a new directory will be created at the specified path. If the path did
not already exist, a new directory is created with the proper
permissions.</p>
<p>By default, directories are created with 0o700 permissions (i.e. rwx
only for the owner). Some directories, for example
<code class="docutils literal notranslate"><span class="pre">/run/geopm</span></code>, also require execution permissions (i.e.
0o711). For more details on how directories are created and default
permissions, please see the <a class="reference internal" href="geopmdpy.7.html#module-geopmdpy.system_files"><span class="std std-ref">system_files.py</span></a>
documentation</p>
<p>When making files, a temporary file is first created with 0o600 or
owner rw only permissions. The desired contents are then written to
this temporary file. Once writing is complete, the temporary file is
renamed to the desired path while preserving the 0o600
permissions. This rename is atomic, so it is not possible for files to
exist with partial/corrupt data. Any existing file at the desired
location will be overwritten.</p>
<p>When reading files, first the path’s security is verified.  The
implementation asserts that the path describes an existing regular
file which is not a link nor a directory.  After the path is verified,
a file descriptor is opened referencing the path and this file
descriptor’s security is verified.  The implementation asserts that
the descriptor refers to a regular file owned by the calling process
UID/GID and that the file descriptor has minimal permissions
(i.e. 0o600 or rw for the owner only).  After these assertions have
been made, the implementation reads the entire file contents into a
string buffer and the file descriptor is closed.</p>
</section>
<section id="external-dependencies">
<h3>External Dependencies<a class="headerlink" href="#external-dependencies" title="Link to this heading"></a></h3>
<p>The GEOPM Service relies on shared libraries for user plugins related to
IOGroups and Agents. These plugins are expected to be in a specific disk
path set by system administrators. Only validated shared objects in this
designated location are loaded during service startup and used upon user
request.</p>
<p>The GEOPM Service is a systemd service unit which is
configured through the
<a class="reference external" href="https://man7.org/linux/man-pages/man5/systemd.service.5.html">systemd.service(5)</a>
file.  The configuration file provided with the GEOPM source code,
<a class="reference external" href="https://github.com/geopm/geopm/blob/dev/geopmdpy/geopm.service">geopm.service</a>,
does not export the <code class="docutils literal notranslate"><span class="pre">GEOPM_PLUGIN_PATH</span></code> environment variable before
launching <code class="docutils literal notranslate"><span class="pre">geopmd</span></code>, so this feature is disabled by default.</p>
<p>GEOPM also uses third-party JSON libraries for C/C++ runtime and multiple
Python modules for the GEOPM Service. Nightly integration tests ensure the
latest versions of these external Python modules function as expected, with any
issues being promptly reported to developers. For C/C++ JSON usage, the
upstream repository is regularly checked to confirm the GEOPM-hosted code
remains current.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="service_readme.html" class="btn btn-neutral float-left" title="GEOPM Service" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="client.html" class="btn btn-neutral float-right" title="Service Clients" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015 - 2025 Intel Corporation. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>